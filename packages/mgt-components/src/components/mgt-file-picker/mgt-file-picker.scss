/**
 * -------------------------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.
 * See License in the project root for license information.
 * -------------------------------------------------------------------------------------------
 */

@import '../../../../../node_modules/office-ui-fabric-core/dist/sass/References';
@import '../../styles/shared-styles.scss';

:host {
  --flyout-width: 300px;
  --flyout-background-color: #ffffff;
  --item-background-color: #ffffff;
  --item-background-color-hover: #f3f2f1;
  --item-background-color-selected: #f3f2f1;

  display: inline-block;
  user-select: none;
  font-family: var(--default-font-family);

  .button {
    border: 1px solid #c4c4c4;
    border-radius: 2px;
    background-color: #f3f2f1;
    color: #000000;
    cursor: pointer;
    display: flex;
    flex-direction: row;
    width: 200px;

    .button__text {
      padding: 4px 12px;
      flex-grow: 1;
      white-space: nowrap;
      overflow: hidden;
    }

    .button__icon {
      background-color: #f3f2f1;
      border-left: 1px solid #c4c4c4;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 4px 8px;
    }
  }

  .flyout {
    .flyout-root {
      display: flex;
      flex-direction: column;
      width: var(--flyout-width);
      max-width: var(--flyout-width);
      background-color: var(--flyout-background-color);
      max-height: 400px;
    }

    &.loading {
      .spinner {
        margin: 12px;
        display: flex;
        justify-content: center;
      }
    }

    &.disabled {
      .button {
        opacity: 0.5;
      }
    }
  }

  .header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 12px;

    .header__title {
      font-size: 14px;
      line-height: 16px;
      color: #323130;
      font-weight: 600;
    }

    .header__all-items {
      font-size: 14px;
      color: #0078d4;
      cursor: pointer;

      &:hover {
        text-decoration: underline;
        color: #004578;
      }
    }
  }

  .items {
    padding-bottom: 12px;
    overflow-y: auto;

    .item {
      border-top: 1px solid transparent;
      border-bottom: 1px solid transparent;
      position: relative;
      display: flex;
      align-items: center;
      padding: 4px 12px;
      cursor: pointer;
      background-color: var(--item-background-color);

      .item__icon {
        max-height: 24px;
        max-width: 24px;
        display: flex;
        align-items: center;
        justify-content: center;
      }

      .item__details {
        .item__title {
          overflow: hidden;
          white-space: nowrap;
          text-overflow: ellipsis;
          margin: 0px 8px;
          font-size: 14px;
          line-height: 20px;
          color: #323130;
        }

        .item__last-used {
          overflow: hidden;
          white-space: nowrap;
          text-overflow: ellipsis;
          padding: 0px 8px;
          font-size: 12px;
          line-height: 16px;
          color: #797775;
        }
      }

      &:hover {
        background-color: var(--item-background-color-hover);
      }

      &.item--selected {
        border-top-color: #c4c4c4;
        border-bottom-color: #c4c4c4;
        background-color: var(--item-background-color-selected);
      }
    }
  }
}
